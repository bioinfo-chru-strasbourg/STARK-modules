##########################################################################
# Config Yaml Version:     0.1
# Description:             Yaml file to run DECON Snakefile module
##########################################################################
# DEV version 0.1 : 10/11/2021
# INT version 0.1 : 17/03/2022
# PROD version 1 : 03/06/2022
# Authoring : Thomas LAVAUX
# PROD version 2 : 16/06/2022 changelog
# add the possibility to analyse gender separately, extract gender from tag files ; gender analysis can be set with REMOVE_F & REMOVE_M & REMOVE_A options
# add a gene list restriction to limit the analysis to a certain list of gene's name (GENE_FILTER & GENE_LIST_RESTRICT)
# add a chr filter option to remove chrosome (essentially chrY) CHR_FILTER & CHR_LIST_RESTRICT)
##########################################################################
# Add here variables that will extend default configuration yaml file.
# If a variable was already defined in the default configuration yaml file, it will be replace.
# launch snakemake -s snakefile_decon -c(numberofthreads) --config run=absolutepathoftherundirectory var1=0.05 var2=12
# separate multiple variable with a space
################## Directories and variables ##################

# Name of the module = {serviceName} from listener.py/launcher.py
serviceName: "DECON"
# Default repository/depository path from listener.py/launcher.py
repository: "/STARK/output/repository"
depository: "/STARK/output/depository"
# Output directory if not repository
OUTPUT_DIR: ""
# Copy to depot directory (archive)
DEPOT_COPY: True

# Group and App default name
GROUP_NAME: "UNKNOWN"
APP_NAME: "UNKNOWN"
# Default path to the input datas == {run} from listener.py/launcher.py
run: ""
# Bed file
BED_FILE: ""
# Genes file
GENES_FILE: ""
# Transcripts file
TRANSCRIPTS_FILE: ""
# List genes
LIST_GENES: ""

### TOOLS PATH ###
# Default path to a FASTA file with .fasta reference genome (hg19/hg38 for ex)
REFGENEFA_PATH: "/STARK/databases/genomes/current/hg19.fa"
# Default path to Refgene file containing custom exon numbers
REFSEQGENE_PATH: "/STARK/databases/refGene/current/formated_refgene.tsv"

# Paths
SCRIPTS_PATH: "/app/scripts/python"
SCRIPTS_CONFIG: "/app/config/fileconversion"
DUMMY_PATH: "/app/scripts/dummy"

# Samples list exclusion (not to be analyse) ; exclude if startwith, case insensitive
EXCLUDE_SAMPLE: ['POOL_', 'BlcADN', 'blanc', 'BlcPCR', 'blcPCR', 'Z_NTC', 'NTC', 'Blc']
# Sample filter
FILTER_SAMPLE: []

### Indexing files options
# Ext to index (endwith)
EXT_INDEX_LIST: [".cram", ".cram.crai", ".transcripts", ".genes.bed", ".design.bed", ".bam", ".bam.bai", ".list.genes", ".tag"]
# Process .bam or .cram
PROCESS_FILE: [".bam"]
# Process input files : cram/cp/rsync/ls/filterbam
PROCESS_CMD: 'cp'
# Only analyse validation.bam/cram files
VALIDATION_ONLY: False
# Append an aligner name if no empty (from sample.bam to sample.aligner_name.bam)
ALIGNER_NAME:

# Rsync options bash notation
INCLUDE_RSYNC: "{'*Unfiltered.vcf.gz','*Unfiltered.vcf.gz.tbi','*Design.vcf.gz','Design.vcf.gz.tbi','*AnnotSV.Unfiltered.tsv','*AnnotSV.Design.tsv','*Design_results_all.tsv','*Metrics.tsv','*.bed','*list.txt','*.pdf','*/'}"
# for log file copy if pipeline failed
INCLUDE_LOG_RSYNC: "{'*.log','*.err','*Failed.txt','*.bed'}"

##### Search parameters of input for the search function #####
RECURSIVE_SEARCH: False
SEARCH_ARGUMENT: "/*/STARK/*"
# For samtools indexing
THREADS: "4"
## DEBUG ##
DEBUG_MODE: False

############## Tools specific parameters ##############
### DECON BED processing ###
# Regen exon number with IntersectBed and a refseqgene reference (True/False) containing a column with the exon number
BED_PROCESS: "STANDARD"
# Keep intergenic region when exon regen is done
KEEP_UNKNOWN: False
# Patch for some gene name
EXON_SEP: False
# Old Bed formating
OLD_BED: True
# Remove M or F or Autosome analysis
# Default is autosome with all the patients ; chrX can be performed only for Male or Female patients, with a separate call by sex
REMOVE_F: False
REMOVE_M: False
REMOVE_A: False
# Limit the analysis to a list of genes (remove from DECON BED)
GENE_LIST_RESTRICT: []
# List of chr to remove from DECON BED
CHR_LIST_RESTRICT: []

# If bed file got a 5 column with exon number 
customexon: FALSE
# kmerisation of DECON bed (integer) (ex 250)
KMER: ""


# Path to Decon R directory
DECON_PATH: "/app/scripts/R"

############# ReadInbams params ##############
# path to the tsv file containing 2 columns : bam for the list of reference bams for CNV calling (full path of bams), and gender (F/M)
# the bam files have to be indexed
# number of reference patients should be 10 or more, and if the gender is considere, 10 per gender
# the panel of genes and the technology of sequencing (capture/amplicon) must be identical between reference samples and patient samples
# REF_BAM_LIST: "--refbams /app/res/list.tsv"
REF_BAM_LIST: ""
# Max cores to use
MCORES: 16
############# IdentifyFailures params ##############
mincorr: 0.98 # Minimum correlation threshold – the minimum correlation between a test sample and any other sample for the test sample to be considered well-correlated (default 0.98)
mincov: 100 # Minimum coverage threshold – the minimum median coverage for any sample (measured across all exons in the target) or exon (measured across all samples) to be considered well-covered (default 100)

############# makeCNVcalls params ##############
transProb: 0.01 # Transition probability – the transition probability between normal copy number state and either deletion or duplication state in the hidden Markov model, 0.01 is a high threshold value to increase sensitivity (default 0.01)

############# AnnotSV params ##############
hpo: # HPO terms list describing the phenotype of the individual being investigated Values: use comma, semicolon or space separated class values Default = "" (e.g.: "HP:0001156,HP:0001363,HP:0011304") = only for individual analysis
genomeBuild: GRCh37 # GRCh38 default, set to GRCh37 for hg19
overlap: 100 # default 100
annotationMode: split # split, full or both (defaut both)
annotationdir: "/STARK/databases/AnnotSV/3.3.6/" # path to the annotation database (3.3.6)